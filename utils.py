#!/usr/bin/python3
# -*- encoding: utf-8 -*-

def obtenerSubs(eleccion):
    subcatDict = {2:'config', 3:'ident', 4:'authn', 5:'authz', 6:'sess', 7:'inpval', 8:'err', 9:'crypst', 10:'buslogic', 11:'client'}
    resultado = ""
    for i in eleccion:
        for k,v in subcatDict.items():
            if str(k) == i:
                resultado += v + ","
    resultado = resultado[:-1]
    return resultado

def obtenerRiesgoSub(pregunta_sub):
    riesgo = 0.0
    for i in pregunta_sub:
        for k,v in i.items():
            riesgo += int(v)
    riesgo /= 4
    return riesgo

def obtenerRiesgoComando(riesgoNegocio):
    cadena = ""
    for k,v in riesgoNegocio.items():
        cadena += str(k) + ":" + str(v) + ","
    cadena = cadena[:-1]

    return cadena

def validarRiesgoNegocio(preguntas, subcat):
    # Asegurar que las preguntas de cada subcategor√≠a sean contestadas.
    subcatList = subcat.split(',')
    lenPreguntas = len(preguntas)

    if ( lenPreguntas % 4 != 0 ) and ( lenPreguntas % (len(subcatList) + 1) == 0 ):
        return None
    
    resultado = list()
    split = 4
    resultado = [preguntas[i:i+split] for i  in range(0, len(preguntas), split)]
    
    lenPreguntas = len(resultado)
    riesgosNegocio = dict()
    i = 0
    while i < lenPreguntas:
        if i == 0:
            riesgosNegocio.update({"info":obtenerRiesgoSub(resultado[i])})
        else:
            riesgosNegocio.update({subcatList[i-1]:obtenerRiesgoSub(resultado[i])})
        i += 1
    
    return riesgosNegocio

